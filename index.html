<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Slides</title>
  <meta 
    name="description" 
    content="Доклад об авторизации">

  <link rel="preload" href="fonts/FiraCode-VariableFont_wght.ttf" as="font" type="font/ttf" crossorigin>
  <link rel="preload" href="fonts/Inter-VariableFont_slnt,wght.ttf" as="font" type="font/ttf" crossorigin>

  <link rel="preload" as="style" href="styles/reset.css">
  <link rel="preload" as="style" href="styles/fonts.css">
  <link rel="preload" as="style" href="styles/SlideController.css">
  <link rel="preload" as="style" href="styles/variables.css">
  <link rel="preload" as="style" href="styles/slide.css">
  <link rel="preload" as="style" href="styles/progress.css">
  <link rel="modulepreload" href="javascript/SlideController.mjs">
  <link rel="modulepreload" href="javascript/Keys.mjs">
  <link rel="modulepreload" href="javascript/Selectors.mjs">
  <link rel="stylesheet" href="styles/SlideController.css">
</head>
<body>
  <main>
    <ol class="slides">

      <li class="slide">
        <figure class="content centred">
          <svg xmlns="http://www.w3.org/2000/svg" width="70%" height="70%" viewBox="740 1050 3600 3000"><defs><style>.fil0{fill:none}.fil1{fill:url(#id0)}</style><linearGradient id="id0" gradientUnits="userSpaceOnUse" x1="735.7" y1="3581.72" x2="4344.3" y2="1498.28"><stop offset="0" stop-color="#0096ff"></stop><stop offset="1" stop-color="#f644d1"></stop></linearGradient></defs><g id="Слой_x0020_1"><path class="fil0" d="M0 0h5080v5080H0z"></path><path class="fil1" d="M998 1732v841l-236 275 236 198v848l1846-325 862 314v-466l373-67v-842l239-278-239-199v-843L998 1733zm124 1246l-186-155 186-216v-772l2832-501v765l187 156-187 217v774l-373 67v391l-724-264-1735 306v-769zm2463-1330v85c0 16-3 32-12 46l-113 192-114-155c-8-11-10-27-10-40v-84l-123 22v90c0 24 4 48 18 68l166 226v207l124-22v-207l166-281c13-22 18-47 18-72v-95l-121 21zm-823 145v623l424-75v-113l-300 53v-509l-124 22zm-364 63l-176 31c-99 18-155 84-155 184v304c0 102 59 152 160 134l176-31c99-18 155-84 155-184v-304c0-89-44-138-121-138-12 0-25 1-38 4zm-207 504v-311c0-30 14-46 43-51l160-28c27-5 39 4 39 32v314c0 30-14 46-44 51l-160 28c-4 1-8 1-12 1-20 0-26-12-26-36zm-455-387v242l-242 43v-242l-124 22v623l124-22v-267l242-43v267l124-22v-623l-124 22zm1305 513l-265 750 128-23 265-750-128 22zm-643 157l-172 30c-94 17-155 74-155 173v45c0 68 31 114 101 120l239 20c16 1 22 8 22 24v63c0 29-18 40-45 45l-161 28c-24 4-40 3-40-25v-86l-122 22v78c0 101 63 139 158 122l179-32c95-17 156-74 156-173v-75c0-69-40-106-107-112l-235-20c-21-2-22-8-22-28v-37c0-29 18-40 45-45l154-27c24-4 40-3 40 25v92l122-22v-84c0-85-47-126-119-126-12 0-25 1-39 4zm-663 117v469c0 31-14 47-44 52l-160 28c-28 5-39-4-39-33v-101l-123 22v93c0 102 59 152 160 134l176-31c99-18 155-84 155-184v-471l-124 22zm1844 193v109l124-22v-109l-124 22zm-211 37v109l124-22v-109l-124 22zm-211 37v109l124-22v-109l-124 22z"></path></g></svg>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred main-title">
          <div class="outer-title">
            <h1><b><span>It's</span><br />perfect!</b></h1>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-1">
          <div>
            <h2>Problem</h2>
          </div>
          <figcaption class="caption"><span>What problem we are trying to solve</span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Why not?</h3>
            <ul>
              <li>Not enough trust</li>
              <li>Not enough information</li>
              <li>Too complex</li>
            </ul>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred advice">
          <div>
            <h3>Trust</h3>
            <p>User should think, that it's safe to use your service</p>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split">
          <div class="half vh screenshot screenshot--report"></div>
          <div class="half vh centred screenshot">
            <img src="images/lastpass.svg" alt="LastPass">
          </div>
        </figure>  
      </li>

      <li class="slide">
        <figure class="content centred advice">
          <div>
            <h3>Trust</h3>
            <p>Show rating and review, make sure that you are responsive and available in used media-channel, add microformats</p>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--rating"></figure>
      </li>

      <li class="slide">
        <figure class="content centred advice">
          <div>
            <h3>Transparency</h3>
            <p>Explain why do you need information and how you are planing to use it. And how you wouldn't use it.</p>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--transparency"></figure>
      </li>

      <li class="slide">
        <figure class="content centred advice">
          <div>
            <h3>Simplicity</h3>
            <p>Do not request data until the moment, when you need it</p>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-2">
          <div>
            <h2>HTML</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-3">
          <div>
            <h2>Forms</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>What forms?</h3>
            <ul>
              <li>Registration (SR Flow)</li>
              <li>Login (SR Flow and dedicated)</li>
              <li>Password recovery</li>
            </ul>
          </div>
        </figure>
      </li>


      <li class="slide">
        <figure class="content illustration illustration--robot">
          <h2 class="cloud"><b>Semantics! <br> BIP!!! </b></h2>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="36"><code class="language-html">&lt;form method=&quot;post&quot; action=&quot;&#x2F;sign-up&#x2F;&quot;&gt;
  &lt;fieldset&gt;
    &lt;legend&gt;Registration&lt;&#x2F;legend&gt;
    &lt;!-- Input fields --&gt;
  &lt;&#x2F;fieldset&gt;
  &lt;button type=&quot;submit&quot;&gt;
    Register
  &lt;&#x2F;button&gt;
&lt;&#x2F;form&gt;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="36"><code class="language-html">&lt;label&gt;
  Email
  &lt;small&gt;We wouldn't send spam&lt;&#x2F;small&gt;
  &lt;input 
    value=&quot;&quot;
    name=&quot;email&quot;
    type=&quot;email&quot; 
    placeholder=&quot;email@gmail.com&quot;&gt;
&lt;&#x2F;label&gt;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-4">
          <div>
            <h2>Attributes</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="67"><code class="language-html">autocorrect="off"
spellcheck="false"
autocapitalize="none"</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Which attributes can be useful?</h3>
            <ul>
              <li>inputmode</li>
              <li>autocomplete</li>
            </ul>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>inputmode</h3>
            <div class="split">
              <ul class="half">
                <li>none</li>
                <li>text</li>
                <li>tel</li>
                <li>url</li>
              </ul>
              <ul class="half">
                <li>email</li>
                <li>numeric</li>
                <li>decimal</li>
                <li>search</li>
              </ul>
            </div>
          </div>
        </figure>
      </li>


      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>autocomplete</h3>
            <ul>
              <li>username</li>
              <li>new-password</li>
              <li>current-password</li>
              <li>one-time-code</li>
              <li>…</li>
            </ul>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="67"><code class="language-html">inputmode=&quot;email&quot;
autocomplete=&quot;email&quot;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split">
          <div class="third vh screenshot screenshot--email"></div>
          <div class="third vh screenshot screenshot--email-android"></div>
          <div class="third vh screenshot screenshot--email-android-2"></div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--email-desktop"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="50"><code class="language-bash">autocomplete=&quot;new-password&quot;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split steps">
          <div class="third screenshot screenshot--new-password-1"></div>
          <div class="third screenshot screenshot--new-password-2"></div>
          <div class="third screenshot screenshot--new-password-save"></div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split steps">
          <div class="third screenshot screenshot--new-password-android-1"></div>
          <div class="third screenshot screenshot--new-password-android-2"></div>
          <div class="third screenshot screenshot--new-password-android-save"></div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--new-password-desktop"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="42"><code class="language-html">autocomplete=&quot;current-password&quot;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split">
          <div class="screenshot screenshot--current-password third vh "></div>
          <div class="screenshot screenshot--current-password-android-1 third vh "></div>
          <div class="screenshot screenshot--current-password-android-2 third vh "></div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--current-password-desktop"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="48"><code class="language-html">inputmode=&quot;numeric&quot;
autocomplete=&quot;one-time-code&quot;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="64"><code class="language-js">
`${code} is your 
  authentication code.
  @${domain} #${code}`
            </code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split steps">
          <div class="quarter vh screenshot screenshot--sms-1"></div>
          <div class="quarter vh screenshot screenshot--sms-2"></div>
          <div class="quarter vh screenshot screenshot--sms-3"></div>
          <div class="quarter vh screenshot screenshot--sms-4"></div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--sms-input"></figure>
      </li>

      <li class="slide">
        <figure class="content split steps">
          <div class="screenshot screenshot--settings-1 third vh "></div>
          <div class="screenshot screenshot--settings-2 third vh "></div>
          <div class="screenshot screenshot--settings-3 third vh "></div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--desktop-sms-input"></figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>iOS look for words next to numbers</h3>
            <ol>
              <li>code</li>
              <li>passcode</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Chrome and Android don't support declarative approach to OTP autocomplete</h3>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="sms-title">Origin-bound one-time codes delivered via SMS</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/sms.svg" alt="QR-Code with link to Origin-bound one-time codes delivered via SMS specification">
            <a aria-label="Read about the SMS format that we should use to make autocomplete work." target="_blank" data-click href="https://wicg.github.io/sms-one-time-codes/">Read about SMS format that we should use to make autocomplete work</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="sms-title">Automatic Strong Passwords and Security Code AutoFill</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/wwdc2018.svg" alt="QR-Code with link to a page with WWDC 2018 video">
          <a aria-label="Watch presentation from Apple WWDC 2018, that show new funcionality of iOS 12" target="_blank" data-click href="https://developer.apple.com/videos/play/wwdc2018/204/">Watch presentation from Apple WWDC 2018, that show new funcionality of iOS 12</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2>HTML Living Standard</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/autofill.svg" alt="QR-Code with link to a page, that allow to buy Form Design Patterns">
            <a aria-label="Open Autocomplete section of HTML specification" target="_blank" data-click href="https://html.spec.whatwg.org/multipage/form-control-infrastructure.html#autofill">Read about autocoplere</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <img class="half book-illustration" src="images/book-design-patterns.png" alt="Form Design Patterns Book">
          <div class="half">
            <img class="book-qrcode" src="images/book-design-patterns.svg" alt="QR-Code with link to places wherer tou may buy book Form Design Patterns">
            <a aria-label="Buy Form Design Patterns" target="_blank" data-click href="https://www.smashingmagazine.com/printed-books/form-design-patterns/">Buy the book</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-5">
          <div>
            <h2>Data source</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content illustration illustration--robot-2">
          <h2 class="cloud"><b>All your passwords<br> belong to us! BOP!</b></h2>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--save-password"></figure>
      </li>

      <li class="slide">
        <figure class="content illustration illustration--scream">
          <h2 class="cloud"><b>Se-e-e-et the na-a-a-ame!</b><span></span></h2>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="48"><code class="language-html">&lt;StyledInput
  ref={emailInputRef}
  type=&quot;email&quot;
  onChange={setEmail}
  value={email}
  autoComplete=&quot;email&quot;
  &#x2F;&gt;</code></pre>
          <figcaption class="caption"><span>
            I mean, we develop react application. 
            We don't usually send forms anywhere. 
            We don't have fallbacks and can't use it without JavaScript.
            There is a temptation to skip the name attribute.
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot  screenshot--nonames">
          <figcaption class="caption"><span>
            But then we would see this.
            Phone number instead of the user name, how come?
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list ">
          <div>
            <h3>Chrome and Firefox</h3>
            <ol>
              <li>username</li>
              <li>field before password</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list ">
          <div>
            <h3>Safari</h3>
            <ol>
              <li>username</li>
              <li>email</li>
              <li>field before password</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="48"><code class="language-html">autocomplete=&quot;username email&quot;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--autofill">
          <figcaption class="caption"><span>
            You can find all your autocomplete passwords, addresses and payment methods in browser settings
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--add-list">
          <figcaption class="caption"><span>
            You can manage addresses saved from forms
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--add">
          <figcaption class="caption"><span>
            And more then that: you can add your ones
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split steps">
          <div class="screenshot screenshot--password-1 third vh "></div>
          <div class="screenshot screenshot--password-2 third vh "></div>
          <div class="screenshot screenshot--password-3 third vh "></div>
          <figcaption class="caption"><span>
            On iOs you can manage sources for autocomplete.
            iCloud Keychain by default.
            And one other additional source.
            Chrome one.
            Or Lockwise from FireFox.
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--can-change-password">
          <figcaption class="caption"><span>
            Aside from auto-completing, a browser can find compromised passwords
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-6">
          <div>
            <h2>Password change</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="42"><code class="language-js">server.use(
"/.well-known/change-password", 
(req, res) => {
  res.redirect("/reset-password");
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
            <pre data-code="36"><code class="language-nginx">
server {
  rewrite 
    ^/.well-known/change-password$ 
    http://domain.com/reset-password
    redirect;
}
              </code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list ">
          <div>
            <h3>Expected responces</h3>
            <ul>
              <li>302 Found</li>
              <li>303 See Other</li>
              <li>307 Temporary Redirect</li>
            </ul>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--restore"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="42"><code class="language-js">server.use(`
  /.well-known/resource-that-
  should-not-exist-whose-status-
  code-should-not-be-200`,
  (req, res) => {
    res.status(404).end();
  });</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list ">
          <div>
            <h3>Expected responces</h3>
            <ul>
              <li>404 Not Found</li>
            </ul>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">A Well-Known URL for Changing Passwords</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/change-password.svg" alt="QR-Code with link to A Well-Known URL for Changing Passwords specification">
            <a aria-label="Open specification Changing Passwords in the browser" target="_blank" data-click href="https://w3c.github.io/webappsec-change-password-url/">Read specification URL for Changing Passwords from the browser</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-7">
          <div>
            <h2>JavaScript</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-0">
          <div>
            <h2>Credential Management</h2>
          </div>
          <figcaption class="caption"><span>
            Let's discuss the Credential Management specification. This one is special: it is extendable.
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="64"><code class="language-js">navigator.credentials</code></pre>
          <figcaption class="caption"><span>
            navigator.credentials is root object for everything. 
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="42"><code class="language-js">.create(CredentialCreationOptions)
.store(Credential)
.get(CredentialRequestOptions)
.preventSilentAccess()</code></pre>
          <figcaption class="caption"><span>
            .create allow to build a credential object, .store allow to store it to the browser and .get — request them back. .preventSilentAccess will switch off silent login functionality
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list ">
          <div>
            <h3>Credential types:</h3>
            <ul>
              <li>PasswordCredential</li>
              <li>FederatedCredential</li>
              <li>OTPCredential&nbsp;(WebOTP)</li>
              <li>PublicKeyCredential&nbsp;(WebAuthn)</li>
            </ul>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred advice problems-list">
          <div>
            <h3>PasswordCredential</h3>
            <p>Authentication with login and password.</p>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred advice problems-list">
          <div>
            <h3>CredentialData: </h3>
            <ol>
              <li>id</li>
            </ol>
          </div>
          <figcaption class="caption"><span>
            The basic object called CredentialData and only property is "id"
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>PasswordCredential: </h3>
            <ol>
              <li>name</li>
              <li>iconURL</li>
              <li>password</li>
              <li>type: "password"</li>
            </ol>
          </div>
          <figcaption class="caption"><span>
            PasswordCredential adds fields on top of that
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--registration-1"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="32" data-line="5-9"><code class="language-js">const signUpHandler = async (event) => { 
  // Registration
  const form = event.currentTarget;
  if (window?.PasswordCredential) {
    const credential = await navigator.
      credentials.create({
        password: form
      });
    navigator.credentials.store(credential);
  }
}</code></pre>
          <figcaption class="caption"><span>
            After registration we can create credentials directly from form object
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="26" data-line="5-6"><code class="language-js">const signUpHandler = (event) => { 
  // Registration
  const form = event.currentTarget;
  if (window?.PasswordCredential) {
    const credential = new PasswordCredential(form);
    navigator.credentials.store(credential);
  }
}</code></pre>
          <figcaption class="caption"><span>
            We can use PasswordCredential as a shortcut
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--registration-2">
          <figcaption class="caption"><span>
            Interesting fact: if the user chooses to use the autogenerated password, the browser will just save the form without additional interactions
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--registration-3">
          <figcaption class="caption"><span>
            Otherwise, the user will have to confirm this
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="36"><code class="language-js">function signUpHandler (event) { 
  // Registration
  const form = event.currentTarget;
  const data = new FormData(form);

  if (window?.PasswordCredential) {
    // …
  }
}</code></pre>
          <figcaption class="caption"><span>
            But what if we would want to have more control over the data we save?
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="36"><code class="language-js">const credential = 
  new PasswordCredential({
    id: data.get('email'),
    name: data.get('firstName'),
    password: data.get('password'),
    iconURL: data.get('avatar'),
  });
navigator.credentials.store(credential);</code></pre>
          <figcaption class="caption"><span>
            Then we can pass specific data to the method and this will enable us to set avatar for example or choose which field would be the name
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split gap nowrap">
          <div class="half vh screenshot screenshot--registration-4"></div>
          <div class="half vh screenshot screenshot--registration-5"></div>
        </figure>  
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="48"><code class="language-js">navigator.credentials.get()</code></pre>
          <figcaption class="caption"><span>
            To use credentials, we should request them from the browser
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>CredentialRequestOptions: </h3>
            <ol>
              <li>mediation 
                <ul>
                  <li>silent</li>
                  <li>optional</li>
                  <li>required</li>
                </ul>
              </li>
              <li>signal</li>
            </ol>
          </div>
          <figcaption class="caption"><span>
            And we need to create CredentialRequestOptions to do so. 
            Mediation conception is critical for understanding.
            <!-- Silent means that when we request credentials for this origin browser should return them without any user interaction if he can or just return null otherwise.
            Browser can return credential if folowing conditions are satisfied:
            - Browser have credentials for this origin
            - Browser have only one credentials set for this origin
            - Prevent Silent Access was not called -->
          </span></figcaption>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>PasswordCredential: </h3>
            <ol>
              <li>password: true  </li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="32"><code class="language-js">(async () => {
  if (window?.PasswordCredential) {
    const credential = 
      await navigator.credentials.get({
        password: true,
        mediation: 'silent',
      });
    if (credential === null) return;
    // Authentication
    // Error handling
}})();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>PasswordCredentialData: </h3>
            <ol>
              <li>id</li>
              <li>name</li>
              <li>iconURL</li>
              <li>password</li>
              <li>type: "password"</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--signedin"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="32" data-line="5"><code class="language-js">if (window?.PasswordCredential) {
  const credential = 
    await navigator.credentials.get({
      password: true,
      mediation: 'optional',
    });
  if (credential === null) return;
  // Authentication
  // Error handling
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--signedin-selector-1"></figure>
      </li>


      <li class="slide">
        <figure class="content centred screenshot screenshot--signedin-selector-2"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="42"><code class="language-js">if (navigator?.credentials
    .preventSilentAccess) {
  await navigator?.credentials
    .preventSilentAccess(id);
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split steps">
          <div class="half vh screenshot screenshot--signedin-selector-2"></div>
          <div class="half vh screenshot screenshot--signedin-cross"></div>
        </figure>  
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>FederatedCredentialData:</h3>
            <div class="split">
              <ul class="third">
                <li>id</li>
                <li>name</li>
                <li>iconURL</li>
              </ul>
              <ul class="two-thirds">
                <li>provider</li>
                <li>protocol</li>
                <li>type: "federated"</li>
              </ul>
            </div>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--credentials-support-1"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--credentials-support-2"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--no"></figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">The Credential Management API (Web Fundamentals)</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/web-fun-credential.svg" alt="QR-Code with link to an Web Fundamentals article about Credential Management API usage">
            <a aria-label="Open an aricle about Credential Management" target="_blank" data-click href="https://developers.google.com/web/fundamentals/security/credential-management">Read how to use Credential Management in practice</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Credential Management</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/credentials.svg" alt="QR-Code со ссылкой на спецификацию Credential Management">
            <a aria-label="Open Credential Management specification" target="_blank" data-click href="https://w3c.github.io/webappsec-credential-management/">Read Credential Management specification</a>
          </div>
        </figure>
      </li>

      <!-- <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="24"><code class="language-bash">$ git checkout masterclass
$ git log --oneline -8
094e9867 step 8: store credentials on registration
067c6952 step 7: store credentials on login
821100d8 step 6: add backward compatibility for login link
83aa2d61 step 5: adding optional login
a4ded8aa step 4: prevent silent login on logout
3b0159de step 3: prevent extra logins
85100d18 step 2: login with credentials
7d52c823 step 1: get credentials
</code></pre>
        </figure>
      </li> -->

      <li class="slide">
        <figure class="content centred sub-title sub-title-1">
          <div>
            <h2>Web&nbsp;OTP&nbsp;API</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>OTPCredential</h3>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="42"><code class="language-js">if ('OTPCredential' in window) {
  const { code, type } = await 
    navigator.credentials.get({
      otp: { transport:['sms'] }
    });

  if (!code) return;
  // Authentication
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content split">
          <div class="half vh screenshot screenshot--emulator-send"></div>
          <div class="half vh screenshot screenshot--emulator-recieve"></div>
        </figure>  
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Requirements for SMS in Chrome for Android: </h3>
            <ol>
              <li>The message must contain 4-10 alphanumeric characters, at least 1 of which is a number</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Requirements for SMS in Chrome for Android: </h3>
            <ol start="2">
              <li>You must send a message from a number that does not belong to the user's contacts.</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Verify phone numbers on the web with the Web OTP API (Web Fundamentals)</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/webotp.svg" alt="QR-Code with link to an article on Web Fundamentals about SMS OTP autocomplete under Chrome for Android with Web OTP API">
            <a aria-label="Read about about SMS OTP autocomplete under Chrome for Android with Web OTP API" target="_blank" data-click href="https://web.dev/web-otp/">Read about SMS OTP autocomplete under Chrome for Android with Web OTP API</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="sms-title">Origin-bound one-time codes delivered via SMS</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/sms.svg" alt="QR-Code with link to a specification on Origin-bound one-time codes delivered via SMS">
            <a aria-label="Read about sms format in the origin-bound one-time codes delivered via SMS specification" target="_blank" data-click href="https://wicg.github.io/sms-one-time-codes/">Read about sms format in the origin-bound one-time codes delivered via SMS specification</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2>Web OTP API</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/otp-api.svg" alt="QR-Code with link to Web OTP API specification">
            <a aria-label="Read Web OTP API specification, which we must use to aquire SMS from script" target="_blank" data-click href="https://wicg.github.io/web-otp/">Read how with Web OTP API, we can aquire SMS from script</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-3">
          <div>
            <h2>isLoggedIn Web API</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="64"><code class="language-js">navigator.setLoggedIn
navigator.setLoggedOut
navigator.isLoggedIn</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--stub"></figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="isloggedin-title">isLoggedIn<br>Web API</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/isloggedin.svg" alt="QR-Code with link to isLoggedIn Web API specification">
            <a aria-label="Read isLoggedIn Web API specification" target="_blank" data-click href="https://github.com/privacycg/is-logged-in">Read how to notify browser that user is authenticated</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred sub-title sub-title-4">
          <div>
            <h2>WebAuthn</h2>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>PublicKeyCredential</h3>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Кросс-платформенные</h3>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred illustration illustration--key"></figure>
      </li>

      <li class="slide">
        <figure class="content centred illustration illustration--phones"></figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list">
          <div>
            <h3>Платформенные</h3>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred illustration illustration--plaform"></figure>
      </li>

      <li class="slide">
        <figure class="content centred illustration illustration--macbook-touch-id"></figure>
      </li>

      <li class="slide">
        <figure class="content centred illustration illustration--plaform-android"></figure>
      </li>

      <li class="slide">
        <figure class="content centred illustration illustration--plaform-windows"></figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list problems-list--small">
          <div>
            <h3>Платформенный ключ: </h3>
            <ol>
              <li>Пользователь регистрируется</li>
              <li>Мы спрашиваем разрешения для использования платформенного ключа</li>
              <li>Если пользователь соглашается регистрируем ключ и храним id в браузере</li>
              <li>При попытке аутентификации — используем </li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list problems-list--small">
          <div>
            <h3>Кросс-платформенный ключ: </h3>
            <ol>
              <li>Пользователь регистрируется</li>
              <li>Даем ему возможность по его инициативе добавить ключи в профиле и храним их id на сервере</li>
              <li>При попытке аутентификации пользователь вводит логин и сервер присылает связанный список ключей</li>
              <li>Если ключи есть вместо или после ввода пароля авторизируется ключем с пином.</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list problems-list--small">
          <div>
            <h3>Регистрация ключа: </h3>
            <ol>
              <li>Запрашиваем у сервера вызов (challenge), данные о платформе и пользователе</li>
              <li>Передаем их ключу и получаем PublicKeyCredential</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list problems-list--small">
          <div>
            <h3>Регистрация ключа: </h3>
            <ol>
              <li>Отправляем PublicKeyCredential серверу для валидации и сохранения</li>
              <li>Получаем Сredential Id который следует хранить на клиенте</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="38"><code class="language-js">if ('PublicKeyCredential' in window) {
  /* … */ 
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="28"><code class="language-js">const hasPlatformAuthenticator 
  = await PublicKeyCredential
  ?.isUserVerifyingPlatformAuthenticatorAvailable();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="51"><code class="language-js">PublicKeyCredential
  .is
    User
    Verifying
    Platform
    Authenticator
    Available();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="28"><code class="language-js">const data = new FormData(form);
const response = await fetch(
  '/challenge/register', 
  {
    method: 'POST',
    body: JSON.stringify({
      name: data.get('name'),
      email: data.get('email'),
      'new-password': data.get('new-password'),
    }),
  });

const options = await response.json();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="64"><code class="language-bash">npm i -S fido2-library</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="30"><code class="language-js">const { Fido2Lib } = require("fido2-library");

const f2l = new Fido2Lib({
  rpId: HOST,
  attestation: "none",
  authenticatorAttachment: "platform",
  authenticatorUserVerification: "discouraged",
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="32"><code class="language-js">const f2l = new Fido2Lib({
  rpId: HOST,
  attestation: "none",
  authenticatorAttachment: "cross-platform",
  authenticatorUserVerification: "required",
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="42"><code class="language-js">fastify.post('/challenge/register/',
  async (request, reply) => {
    const { email, name } 
      = JSON.parse(request.body);
    // User registration
    // …
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="32"><code class="language-js">const options = await f2l.attestationOptions();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding split">
          <pre data-code="20" class="half vh"><code class="language-json">{
  🔴 rp: {
    🔴 name 
    🟢 id // origin
    🟢 icon
  },
  🔴 user: {
    🔴 id,❗️
    🔴 displayName,
    🔴 name,
    🟢 icon,
  },
  🔴 challenge,❗
  🔴 pubKeyCredParams,</code>
          </pre>
          <pre data-code="20" class="half vh"><code class="language-json">  🟢 timeout,
  🟢 excludeCredentials,
  🟢 authenticatorSelection: {
     authenticatorAttachment: [
       "platform",
       "cross-platform"
     ],
     requireResidentKey,
     userVerification: [
       "required",
       "preferred",
       "discouraged"
     ]
  },
  🟢 attestation,
  🟢 extensions,
}</code>
          </pre>
        </figure>  
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="22"><code class="language-json">{
  "rp": { 
    "name": "Anonymous Service", 
    "id": "nice-cheetah-30.loca.lt" },
  "user": {
    "id": [ArrayBuffer],
    "name": "thesilentimp@gmail.com",
    "displayName": "Anton Nemtsev" },
  "challenge": [ArrayBuffer],
  "pubKeyCredParams": [
    { "type": "public-key", "alg": -7 },
    { "type": "public-key", "alg": -257 }
  ],
  "timeout": 60000,
  "attestation": "none",
  "authenticatorSelection": { 
    "userVerification": "discouraged" }}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="41"><code class="language-js">const toBuffer = (base64) => {
  const ASCIIString = atob(base64);
  return Uint8Array.from(
    ASCIIString, 
    c => c.charCodeAt(0)
  ).buffer;
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="41"><code class="language-js">const toBase64 = (buffer) => {
  const binaryString = 
    String.fromCharCode.apply(
      null, 
      new Uint8Array(buffer));
  return btoa(binaryString);
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="28"><code class="language-js">const challengeString = toBuffer(options.challenge);
request.session.set('challenge', challengeString);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="36"><code class="language-js">options.challenge = challengeString;

options.user = {
  id: nanoid(), // Hash of id from DB
  name: email,
  displayName: name,
};</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="48"><code class="language-js">reply
  .type('application/json')
  .code(200)
  .send(options);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="30"><code class="language-js">options.user.id = toBuffer(options.user.id);
options.challenge = toBuffer(options.challenge);

const credential = await navigator.credentials
  .create({
    publicKey: options
  });</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--ff-key"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--chrome-key"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--chrome-key-list-1"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--chrome-key-flag"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--chrome-key-list-2"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--chrome-key-list-3"></figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--cable"></figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split steps">
          <figure class="half vh screenshot screenshot--safari-face-id-1"></figure>
          <figure class="half vh screenshot screenshot--safari-face-id-2"></figure>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split steps">
          <figure class="third vh screenshot screenshot--safari-key-1"></figure>
          <figure class="third vh screenshot screenshot--safari-key-2"></figure>
          <figure class="third vh screenshot screenshot--safari-key-3"></figure>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split steps">
          <figure class="third vh screenshot screenshot--android-key-1"></figure>
          <figure class="third vh screenshot screenshot--android-key-2"></figure>
          <figure class="third vh screenshot screenshot--android-key-3"></figure>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding">
          <pre data-code="38"><code class="language-js">{
  id: "nZOlyXf57erlQbudIIuOrQEdRUs",
  rawId: [ArrayBuffer],
  response: {
    attestationObject: [ArrayBuffer],
    clientDataJSON: [ArrayBuffer],
  },
  type: "public-key",
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="35"><code class="language-js">const {
  id,
  type,
  response: {
    clientDataJSON: clientDataBuffer,
    attestationObject: attestationBuffer,
}} = credential;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="28"><code class="language-js">const clientDataJSON = toBase64(clientDataBuffer);
const attestationObject = toBase64(attestationBuffer);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="45"><code class="language-js">const attestation = {
  id,
  type,
  response: {
    clientDataJSON,
    attestationObject,
  },
};</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="34"><code class="language-js">const body = JSON.stringify(attestation);

const response = await fetch(`/register`, {
  method: "POST",
  body,
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="28"><code class="language-js">const { credentialId } = await response.json();
localStorage.setItem('credentialId', credentialId);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="32"><code class="language-js">fastify.post(
 'register/',
  async (request, reply) => {
    const { session } = request;
    const challenge = session.get('challenge');

    // …
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="46"><code class="language-js">const assertionExpectations = {
  challenge,
  origin: `https://${HOST}`,
  factor: "either"
};</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="20"><code class="language-js">const clientAttestationResponse = JSON.parse(request.body);  
clientAttestationResponse.rawId = toBuffer(clientAttestationResponse.Id);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="32"><code class="language-js">const result = await f2l.attestationResult(
  clientAttestationResponse, 
  assertionExpectations
);

const { authnrData } = result;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="24"><code class="language-js">const counter = authnrData.get('counter');
const credentialId = authnrData.get('credId');
const publicKey = authnrData.get('credentialPublicKeyPem');

const { session } = request;
session.set('counter', counter);
session.set('credentialId', credentialId);
session.set('publicKey', publicKey);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="29"><code class="language-js">const credentialIdBuffer = authnrData.get('credId');
const credentialId = toBase64(credentialIdBuffer);

reply
  .type('application/json')
  .code(200)
  .send({credentialId});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list problems-list--small">
          <div>
            <h3>Логин с помощью ключа: </h3>
            <ol>
              <li>Проверяем есть ли у нас Сredential Id</li>
              <li>Запрашиваем у сервера вызов (challenge) и данные о платформе</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred problems-list problems-list--small">
          <div>
            <h3>Логин с помощью ключа: </h3>
            <ol start="3">
              <li>Передаем их ключу и получаем PublicKeyCredential</li>
              <li>Отправляем PublicKeyCredential серверу для валидации</li>
            </ol>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="26"><code class="language-js">const credentialId = localStorage.getItem('credentialId');         
if (credentialId === null) return;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="38"><code class="language-js">const response = await fetch(
  '/challenge/login', 
  { method: 'POST' }
);

const options = await response.json();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="48"><code class="language-js">fastify.post(
  '/challenge/login',
  async (request, reply) => {
    
  // …
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="32"><code class="language-js">const options = await f2l.assertionOptions();</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="45"><code class="language-js">{
  challenge: [ArrayBuffer],
  timeout: 60000,
  rpId: HOST,
  userVerification: 'discouraged'
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="32"><code class="language-js">const { session } = request;
const challenge = toBuffer(option.challenge);
session.set('challenge', challenge);
option.challenge = challenge;
reply
  .type('application/json')
  .code(200)
  .send(option);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="26"><code class="language-js">const { challenge } = options;
options.challenge = toBuffer(challenge);
const credentialId = localStorage.getItem('credentialId');
options.allowCredentials = [{ 
  type: "public-key", 
  id: toBuffer(credentialId),
}];</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="28"><code class="language-js">const credential = await navigator.credentials.get({
  publicKey: options
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--login"></figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="32"><code class="language-js">{
  id: "FtjWT4fIT9…zs2LRxuG5fBRj9bA",
  rawId: [ArrayBuffer],
  response: {
    authenticatorData: [ArrayBuffer],
    clientDataJSON: [ArrayBuffer],
    signature: [ArrayBuffer],
    userHandle: null,
  },
  type: "public-key",
}</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="32"><code class="language-js">const {
  id,
  type,
  response: {
    authenticatorData: authenticatorDataBuffer,
    clientDataJSON: clientDataJSONBuffer,
    signature: signatureBuffer,
    userHandle,
  }
} = credential;</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="24"><code class="language-js">const authenticatorData = toBase64(authenticatorDataBuffer);
const clientDataJSON = toBase64(clientDataJSONBuffer);
const signature = toBase64(signatureBuffer);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="36"><code class="language-js">const authenticator = {
  id,
  type,
  response: {
    authenticatorData,
    clientDataJSON,
    signature,
    userHandle,
  },
};</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding client">
          <pre data-code="34"><code class="language-js">const body = JSON.stringify(authenticator);
await fetch('/login', { 
  method: "POST",
  body 
});</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="34"><code class="language-js">const { session } = request;
const challenge = session.get('challenge');
const publicKey = session.get('publicKey');
const prevCounter = session.get('counter');</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="40"><code class="language-js">const assertionExpectations = {
  challenge,
  origin: `https://${HOST}`,
  factor: "either",
  publicKey,
  prevCounter,
  userHandle,
};</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="20"><code class="language-js">const clientAssertionResponse = JSON.parse(request.body);
clientAssertionResponse.rawId = toBuffer(clientAssertionResponse.id);
await f2l.assertionResult(clientAssertionResponse, assertionExpectations);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred no-padding server">
          <pre data-code="80"><code class="language-js">reply.code(204);</code></pre>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred screenshot screenshot--caniuse-webauth"></figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">WebAuthn demo application</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/webauthn-server.svg" alt="QR-Code with link to demo repository">
            <a aria-label="Open application repository" target="_blank" data-click href="https://github.com/SilentImp/webauthn-server">Open application repository</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">A curated list of awesome WebAuthn/FIDO2 resources</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/links.svg" alt="QR-Code with collection of the links to the WebAuthn-related resources">
            <a aria-label="Open the collection of the links to the WebAuthn-related resources" target="_blank" data-click href="https://github.com/herrjemand/awesome-webauthn">Open the collection of the links to the WebAuthn-related resources</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2>WebAuthn guide</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/guide.svg" alt="QR-Code with link to the site with WebAuthn tutorial and demo">
            <a aria-label="Open site with WebAuthn tutorial and demo" target="_blank" data-click href="https://webauthn.guide/">Open site with WebAuthn tutorial and demo</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Introduction to WebAuthn API (Yuriy Ackermann)</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/intro.svg" alt="QR-Code to the series of articles with WebAuthn API introduction, written by Yury Akkerman">
            <a aria-label="Read a series of articles with WebAuthn API introduction, written by Yury Akkerman" target="_blank" data-click href="https://medium.com/@herrjemand/introduction-to-webauthn-api-5fd1fb46c285">Read a series of articles with WebAuthn API introduction, written by Yury Akkerman</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Meet Face ID and Touch ID for the web (WWDC 2020 video)</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/apple-webauthn.svg" alt="QR-Code to WWDC 2020 Face ID and Touch ID presentation for Safari 14.">
          <a aria-label="Watch WWDC 2020 Face ID and Touch ID presentation for Safari 14." target="_blank" data-click href="https://developer.apple.com/videos/play/wwdc2020/10670/">Watch WWDC 2020 Face ID and Touch ID presentation in Safari 14.</a>
          </div>
        </figure>
      </li>

      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Meet Face ID and Touch ID for the web (Webkit blog post)</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/apple-webauthn.svg" alt="QR-Code with link to Webkit blog post on Face ID and Touch ID for the web">
          <a aria-label="Read Webkit blog post on Face ID and Touch ID for the web" target="_blank" data-click href="https://developer.apple.com/videos/play/wwdc2020/10670/">Read Webkit blog post on Face ID and Touch ID for the web.</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Web Authentication and Windows Hello</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/ms-webauthn.svg" alt="QR-Code with link to the Microsoft article with WebAuthn introduction">
            <a aria-label="Read Microsoft article with WebAuthn introduction" target="_blank" data-click href="https://docs.microsoft.com/en-us/microsoft-edge/dev-guide/windows-integration/web-authentication">Read Microsoft article with WebAuthn introduction</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Enabling Strong Authentication with WebAuthn</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/google-webauthn.svg" alt="QR-Code with link to the Google article with WebAuthn introduction">
          <a aria-label="Read Google article with WebAuthn introduction" target="_blank" data-click href="https://developers.google.com/web/updates/2018/05/webauthn">Read Google article with WebAuthn introduction</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Emulate Authenticators and Debug WebAuthn in Chrome DevTools</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/debug.svg" alt="QR-Code with link to the article on WebAuthn debug in Chrome">
            <a aria-label="Read an article on WebAuthn debug in Chrome" target="_blank" data-click href="https://developers.google.com/web/tools/chrome-devtools/webauthn">Read an article on WebAuthn debug in Chrome</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2>Fido Alliance</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/fido.svg" alt="QR-Code with link to Fido Alliance">
          <a aria-label="Open Fido Alliance site" target="_blank" data-click href="https://fidoalliance.org/">Open Fido Alliance site</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2>Yubico (YubiKey)</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/yubico.svg" alt="QR-Code with link to the Yubico web-site">
            <a aria-label="Open Yubico web-site" target="_blank" data-click href="https://www.yubico.com/">Open Yubico web-site</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content centred spec split">
          <div class="half">
            <h2 class="password-title">Web Authentication: An API for accessing Public Key Credentials</h2>
          </div>
          <div class="half">
            <img class="book-qrcode" src="images/webauthn.svg" alt="QR-Code with link to the WebAuthn specification">
            <a aria-label="Open WebAuthn specification" target="_blank" data-click href="https://w3c.github.io/webauthn/">Read WebAuthn specification</a>
          </div>
        </figure>
      </li>
      
      <li class="slide">
        <figure class="content contacts centred spec split">
          <div class="half">
            <h2>Contacts</h2>
            <h3>Anton Nemtsev</h3>
            <img class="company" src="images/werkspot.svg" alt="Werkspot" />
            <ul>
              <li><a 
                class="link"
                target="_blank"
                aria-label="Portfolio: silentimp.info" 
                href="https://silentimp.info/" 
                data-click
              >https://silentimp.info/</a></li>
              <li><a 
                class="link"
                target="_blank"
                aria-label="Twitter: @silentimp" 
                href="https://twitter.com/@silentimp" 
                data-click
              >@silentimp</a></li>
              <li><a 
                class="link"
                target="_blank"
                aria-label="Email: thesilentimp@gmail.com" 
                href="mailto:thesilentimp@gmail.com" 
                data-click
              >thesilentimp@gmail.com</a></li>
            </ul>
          </div>
          <div class="half no-padding">
            <img class="qrcode" src="images/git.svg" alt="QRCODE with presentation link">
          </div>
          <footer>
            <a
              aria-label="Slides" 
              target="_blank"
              class="link" 
              href="https://github.com/SilentImp/webauthn-en" 
              data-click
            >https://github.com/SilentImp/webauthn-en</a>
          </footer>
        </figure>
      </li>
      

    </ol>
  </main>
  <progress id="progress"></progress>

  <!-- <meter id="timer"></meter> -->

  <form class="slide-selector">
    <input 
      aria-label="Page number" 
      autocomplete="off" 
      maxlength="3" 
      size="3" 
      pattern="[0-9]{1,3}" 
      placeholder="1" 
      type="number" 
      inputmode="numeric" 
      name="page">
  </form>

  <!-- <form class="timer-controller">
    <input 
      aria-label="Munutes" 
      autocomplete="off" 
      maxlength="3" 
      size="3" 
      pattern="[0-9]{1,3}" 
      placeholder="30"
      type="number" 
      inputmode="numeric" 
      name="minutes">
  </form> -->

  <!-- <form class="timer-controller">
    <fieldset>
      <label>
        Start at: 
        <input autocomplete="off" placeholder="12:30" type="time" name="start" step="300">
      </label>
      <label>
        Duration is: 
        <input aria-label="Duration is" size="2" autocomplete="off" placeholder="30" type="number" inputmode="numeric" name="duration">
        minutes
      </label>
    </fieldset>
  </form> -->

  <script type="module" src="javascript/SlideController.mjs"></script>
  <script src="javascript/prism.js"></script>
</body>
</html>